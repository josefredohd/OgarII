const _0x525934=_0x365d;function _0x4611(){const _0x18c24b=['lastActivityTime','selectedSkin','isPressingQ','forEach','chatCommands','10893uryCUE','Authentication\x20protocol\x20error','closeReason','./Listener','bind','eatenBy','../primitives/Misc','processNameAndSkinMessage','4qsCUwp','chatEnabled','state','Authentication\x20timeout','send','readUInt32LE','passwordVerified','12xnRHDO','from','onSocketClose','logger','lastChatTime','shouldClose','chatCooldown','decide','./Router','toggleQueued','handle','pong','ejectAttempts','trim','closeSocket','9691xEvwuk','disconnected','reassignPlayerId','4288557wcilkE','exports','7293468QVDbMq','fromCharCode','broadcast','controllingMinions','hasWorld','upgradeLevel','../primitives/Reader','lastVisibleCells','exists','44950DFUUUp','whenPlayerPressQ','protocol','webSocket','../bots/Minion','onChatMessage','712340BkAHxd','4505130qINlWd','tick','onDisconnection','Unexpected\x20message\x20format','protocols','remoteAddress','push','type','cellName','updateVisibleCells','onWorldReset','hasProcessedQ','hasPlayer','slice','now','minionsFrozen','settings','processUserIdMessage','removeAllListeners','owner','score','Try\x20spawning\x20to\x20enqueue.','userId','unknown\x20command,\x20execute\x20/help\x20for\x20the\x20list\x20of\x20commands','close','minionEnableQBasedControl','separateInTeams','closeCode','connection\x20from\x20','globalChat','onVisibleCellUpdate','matchmakerNeedsQueuing','players','readUInt16LE','ownedCells','hasOwnProperty','update','onNewWorldBounds','gamemode','world','ownerId','skin','This\x20server\x20requires\x20players\x20to\x20be\x20queued.','../protocols/Protocol','readUInt16','processAuthentication','ping','socketDisconnected','listener','stack','destroyPlayer','createPlayer','isExternal','connection','8762896ZwHcFL','readUInt8','onSocketMessage','directMessage','_socket','20YdhyEC','execute','sendLeaderboard','onNewOwnedCell','player','cellSkin','matchmaker','offset','length','processProtocolMessage','spawningName','debug','\x20has\x20disconnected','authTimeout'];_0x4611=function(){return _0x18c24b;};return _0x4611();}(function(_0x5bfca4,_0x58c617){const _0x2d25c4=_0x365d,_0x138c1b=_0x5bfca4();while(!![]){try{const _0x2e5e67=parseInt(_0x2d25c4(0x1ab))/0x1*(parseInt(_0x2d25c4(0x198))/0x2)+-parseInt(_0x2d25c4(0x14b))/0x3*(parseInt(_0x2d25c4(0x1b3))/0x4)+-parseInt(_0x2d25c4(0x15c))/0x5*(parseInt(_0x2d25c4(0x1ba))/0x6)+-parseInt(_0x2d25c4(0x14d))/0x7+-parseInt(_0x2d25c4(0x193))/0x8+parseInt(_0x2d25c4(0x15d))/0x9+-parseInt(_0x2d25c4(0x156))/0xa*(-parseInt(_0x2d25c4(0x148))/0xb);if(_0x2e5e67===_0x58c617)break;else _0x138c1b['push'](_0x138c1b['shift']());}catch(_0xe5eb69){_0x138c1b['push'](_0x138c1b['shift']());}}}(_0x4611,0xaf41e));const Router=require(_0x525934(0x1c2)),Reader=require(_0x525934(0x153)),{filterIPAddress}=require(_0x525934(0x1b1));class Connection extends Router{constructor(_0x36c69b,_0x4adb48){const _0x5dc1a1=_0x525934;super(_0x36c69b),this[_0x5dc1a1(0x162)]=filterIPAddress(_0x4adb48[_0x5dc1a1(0x197)][_0x5dc1a1(0x162)]),this[_0x5dc1a1(0x159)]=_0x4adb48,this['connectTime']=Date['now'](),this[_0x5dc1a1(0x1a6)]=Date[_0x5dc1a1(0x16b)](),this[_0x5dc1a1(0x1be)]=Date[_0x5dc1a1(0x16b)](),this[_0x5dc1a1(0x152)]=0x0,this[_0x5dc1a1(0x158)]=null,this[_0x5dc1a1(0x18c)]=![],this['closeCode']=NaN,this[_0x5dc1a1(0x1ad)]=null,this['minions']=[],this[_0x5dc1a1(0x16c)]=![],this[_0x5dc1a1(0x150)]=![],this['minionState']=0x0,this[_0x5dc1a1(0x1a7)]='',this[_0x5dc1a1(0x1b9)]=![],this[_0x5dc1a1(0x173)]=null,this[_0x5dc1a1(0x1a5)]=setTimeout(()=>{const _0x54755e=_0x5dc1a1;!this[_0x54755e(0x1b9)]&&!this['socketDisconnected']&&this[_0x54755e(0x147)](0xfa1,_0x54755e(0x1b6));},0x1388),_0x4adb48['on'](_0x5dc1a1(0x175),this[_0x5dc1a1(0x1bc)][_0x5dc1a1(0x1af)](this)),_0x4adb48['on']('message',this[_0x5dc1a1(0x195)][_0x5dc1a1(0x1af)](this)),_0x4adb48['on'](_0x5dc1a1(0x18b),this[_0x5dc1a1(0x147)][_0x5dc1a1(0x1af)](this,0x3eb,'Unexpected\x20message\x20format')),_0x4adb48['on'](_0x5dc1a1(0x144),this[_0x5dc1a1(0x147)][_0x5dc1a1(0x1af)](this,0x3eb,_0x5dc1a1(0x160)));}[_0x525934(0x175)](){const _0x2e1ba6=_0x525934;if(!this[_0x2e1ba6(0x18c)])return void this[_0x2e1ba6(0x147)](0x3e9,'Manual\x20connection\x20close\x20call');this[_0x2e1ba6(0x169)]&&this[_0x2e1ba6(0x19c)]&&this[_0x2e1ba6(0x18f)](),super[_0x2e1ba6(0x175)](),this[_0x2e1ba6(0x149)]=!![],this['disconnectionTick']=this[_0x2e1ba6(0x1c4)][_0x2e1ba6(0x15e)],this['listener'][_0x2e1ba6(0x15f)](this,this['closeCode'],this[_0x2e1ba6(0x1ad)]),this[_0x2e1ba6(0x159)][_0x2e1ba6(0x16f)]();}static get[_0x525934(0x164)](){const _0x1031b8=_0x525934;return _0x1031b8(0x192);}static get[_0x525934(0x191)](){return!![];}static get[_0x525934(0x177)](){return!![];}[_0x525934(0x1bc)](_0x29d435,_0x4bec91){const _0x547b16=_0x525934;if(this[_0x547b16(0x18c)])return;this[_0x547b16(0x1bd)][_0x547b16(0x1a3)](_0x547b16(0x179)+this[_0x547b16(0x162)]+_0x547b16(0x1a4)),this[_0x547b16(0x18c)]=!![],this[_0x547b16(0x178)]=_0x29d435,this[_0x547b16(0x1ad)]=_0x4bec91;}[_0x525934(0x195)](_0x2de46c){const _0x1556f7=_0x525934;this[_0x1556f7(0x1a6)]=Date[_0x1556f7(0x16b)]();if(!this[_0x1556f7(0x1b9)]){this[_0x1556f7(0x18a)](_0x2de46c);return;}this[_0x1556f7(0x1a1)](_0x2de46c);}[_0x525934(0x18a)](_0x562c3e){const _0x34fd3c=_0x525934;try{const _0x57a3e7=Buffer[_0x34fd3c(0x1bb)](_0x562c3e);let _0x5c5669='',_0x407d68=0x0;while(_0x407d68<_0x57a3e7['length']&&_0x57a3e7[_0x407d68]!==0x0){_0x5c5669+=String[_0x34fd3c(0x14e)](_0x57a3e7[_0x407d68]),_0x407d68++;}if(_0x5c5669==='fredo123'){this['passwordVerified']=!![],clearTimeout(this[_0x34fd3c(0x1a5)]);const _0x3c0899=Buffer[_0x34fd3c(0x1bb)]([0x1]);this[_0x34fd3c(0x159)]['send'](_0x3c0899);if(_0x407d68<_0x57a3e7['length']-0x1){const _0xa2a63=_0x57a3e7[_0x34fd3c(0x16a)](_0x407d68+0x1);_0xa2a63[_0x34fd3c(0x1a0)]>0x0&&setTimeout(()=>{const _0x5bbb11=_0x34fd3c;this[_0x5bbb11(0x1a1)](_0xa2a63);},0x32);}}else this[_0x34fd3c(0x147)](0xfa1,'Invalid\x20password');}catch(_0x54240f){this['closeSocket'](0xfa2,_0x34fd3c(0x1ac));}}[_0x525934(0x1a1)](_0x1dac10){const _0x122e0a=_0x525934;try{const _0x47236b=Buffer['from'](_0x1dac10);if(_0x47236b[_0x122e0a(0x1a0)]===0x0)return;if(_0x47236b[_0x122e0a(0x1a0)]>=0x1&&_0x47236b[0x0]===0x5a){this['processUserIdMessage'](_0x47236b);return;}if(_0x47236b['length']>=0x1&&_0x47236b[0x0]===0x0){this[_0x122e0a(0x1b2)](_0x47236b);return;}const _0x25942c=new Reader(_0x47236b,0x0);if(this[_0x122e0a(0x158)]!==null)this[_0x122e0a(0x158)][_0x122e0a(0x195)](_0x25942c);else{this[_0x122e0a(0x158)]=this[_0x122e0a(0x1c4)][_0x122e0a(0x161)][_0x122e0a(0x1c1)](this,_0x25942c);if(this[_0x122e0a(0x158)]===null){}else{}}}catch(_0x11efec){}}[_0x525934(0x1b2)](_0x2e8842){const _0x41ea48=_0x525934;try{const _0x51c77f=new Reader(_0x2e8842,0x0),_0x132ef9=_0x51c77f[_0x41ea48(0x194)]();if(_0x132ef9!==0x0)return![];let _0xfdcd99='',_0x3f133a;while((_0x3f133a=_0x51c77f[_0x41ea48(0x189)]())!==0x0){_0xfdcd99+=String['fromCharCode'](_0x3f133a);}if(_0x51c77f[_0x41ea48(0x19f)]>=_0x51c77f[_0x41ea48(0x1a0)])return this[_0x41ea48(0x1a2)]=_0xfdcd99,!![];const _0x15113f=_0x51c77f[_0x41ea48(0x194)]()===0x1;let _0x325fd4='';if(_0x15113f&&_0x51c77f[_0x41ea48(0x19f)]<_0x51c77f[_0x41ea48(0x1a0)])while(_0x51c77f[_0x41ea48(0x19f)]<_0x51c77f[_0x41ea48(0x1a0)]&&(_0x3f133a=_0x51c77f[_0x41ea48(0x189)]())!==0x0){_0x325fd4+=String[_0x41ea48(0x14e)](_0x3f133a);}this[_0x41ea48(0x1a2)]=_0xfdcd99,this[_0x41ea48(0x1a7)]=_0x325fd4;if(this['hasPlayer']&&this[_0x41ea48(0x19c)])this[_0x41ea48(0x19c)][_0x41ea48(0x165)]=_0xfdcd99,this[_0x41ea48(0x19c)][_0x41ea48(0x19d)]=_0x325fd4,this[_0x41ea48(0x19c)]['leaderboardName']=_0xfdcd99,this[_0x41ea48(0x19c)]['ownedCells']&&this[_0x41ea48(0x19c)][_0x41ea48(0x17f)][_0x41ea48(0x1a0)]>0x0&&this[_0x41ea48(0x19c)]['ownedCells'][_0x41ea48(0x1a9)](_0x25c5ae=>{const _0x1c621b=_0x41ea48;_0x25c5ae['skin']!==_0x325fd4&&(_0x25c5ae[_0x1c621b(0x186)]=_0x325fd4);});else{}return!![];}catch(_0x33f886){return console['error'](_0x33f886[_0x41ea48(0x18e)]),![];}}[_0x525934(0x16e)](_0x3e7755){const _0x258aaf=_0x525934;try{const _0x14fad0=new Reader(_0x3e7755,0x0),_0x44580e=_0x14fad0[_0x258aaf(0x194)](),_0x39d5e8=_0x14fad0['readUInt32']();let _0x1a2e21='';for(let _0x10d94e=0x0;_0x10d94e<_0x39d5e8;_0x10d94e++){_0x1a2e21+=String[_0x258aaf(0x14e)](_0x14fad0[_0x258aaf(0x189)]());}return this['userId']=_0x1a2e21,this[_0x258aaf(0x169)]&&this[_0x258aaf(0x19c)]&&this[_0x258aaf(0x14a)](_0x1a2e21),!![];}catch(_0x515694){try{const _0xb14ed2=_0x3e7755[0x0],_0x404545=_0x3e7755[_0x258aaf(0x1b8)](0x1);let _0x31f8e6='',_0x95b6b2=0x5;for(let _0x58dfeb=0x0;_0x58dfeb<_0x404545;_0x58dfeb++){_0x31f8e6+=String[_0x258aaf(0x14e)](_0x3e7755[_0x258aaf(0x17e)](_0x95b6b2)),_0x95b6b2+=0x2;}return this[_0x258aaf(0x173)]=_0x31f8e6,this[_0x258aaf(0x169)]&&this[_0x258aaf(0x19c)]&&this['reassignPlayerId'](_0x31f8e6),!![];}catch(_0x34e446){return![];}}}[_0x525934(0x14a)](_0x1e3938){const _0x4b80aa=_0x525934;if(!this[_0x4b80aa(0x169)]||!this[_0x4b80aa(0x19c)])return![];if(this[_0x4b80aa(0x19c)]['id']===_0x1e3938)return!![];const _0x537661=this['player']['id'],_0x1c635e=this['listener'][_0x4b80aa(0x1c4)];if(_0x1c635e[_0x4b80aa(0x17d)][_0x1e3938]){if(_0x1c635e[_0x4b80aa(0x17d)][_0x1e3938][_0x4b80aa(0x155)])return![];else delete _0x1c635e['players'][_0x1e3938];}try{const _0x498169=this[_0x4b80aa(0x19c)]['state'],_0xec417a=this['player'][_0x4b80aa(0x184)],_0x148d77=[...this[_0x4b80aa(0x19c)][_0x4b80aa(0x17f)]],_0x28c9c4=this['player'][_0x4b80aa(0x171)];return this['player']['id']=_0x1e3938,delete _0x1c635e[_0x4b80aa(0x17d)][_0x537661],_0x1c635e[_0x4b80aa(0x17d)][_0x1e3938]=this[_0x4b80aa(0x19c)],_0x148d77[_0x4b80aa(0x1a9)](_0x3cfd5e=>{const _0x27db97=_0x4b80aa;_0x3cfd5e[_0x27db97(0x170)]===this[_0x27db97(0x19c)]&&(_0x3cfd5e[_0x27db97(0x185)]=_0x1e3938);}),_0xec417a&&_0xec417a['players']&&(_0xec417a['players'][_0x537661]===this[_0x4b80aa(0x19c)]&&(delete _0xec417a[_0x4b80aa(0x17d)][_0x537661],_0xec417a[_0x4b80aa(0x17d)][_0x1e3938]=this['player'])),!![];}catch(_0x438e2e){try{this[_0x4b80aa(0x19c)]['id']=_0x537661,_0x1c635e[_0x4b80aa(0x17d)][_0x537661]=this['player'],delete _0x1c635e['players'][_0x1e3938];}catch(_0x5eeea8){}return![];}}['createPlayer'](){const _0x5d456c=_0x525934;super[_0x5d456c(0x190)]();if(this[_0x5d456c(0x173)]&&this[_0x5d456c(0x19c)]&&this[_0x5d456c(0x19c)]['id']!==this[_0x5d456c(0x173)]){const _0x371fc6=(_0x4edc37=0x0)=>{const _0x1c7726=_0x5d456c;if(this[_0x1c7726(0x14a)](this[_0x1c7726(0x173)])){}else _0x4edc37<0x3&&setTimeout(()=>_0x371fc6(_0x4edc37+0x1),0x64);};_0x371fc6();}if(this[_0x5d456c(0x16d)][_0x5d456c(0x1b4)])this[_0x5d456c(0x18d)][_0x5d456c(0x17a)]['add'](this);if(this[_0x5d456c(0x16d)][_0x5d456c(0x17c)])this[_0x5d456c(0x18d)][_0x5d456c(0x17a)][_0x5d456c(0x196)](null,this,_0x5d456c(0x187)),this['listener'][_0x5d456c(0x17a)][_0x5d456c(0x196)](null,this,_0x5d456c(0x172));else this['handle']['matchmaker']['toggleQueued'](this);}[_0x525934(0x15b)](_0x32e9b7){const _0x4fd66f=_0x525934;_0x32e9b7=_0x32e9b7[_0x4fd66f(0x146)]();if(!_0x32e9b7)return;const _0x8db398=this[_0x4fd66f(0x18d)][_0x4fd66f(0x17a)],_0x1c04c1=this[_0x4fd66f(0x1be)];this[_0x4fd66f(0x1be)]=Date[_0x4fd66f(0x16b)]();if(_0x32e9b7['length']>=0x2&&_0x32e9b7[0x0]==='/'){if(!this[_0x4fd66f(0x1c4)][_0x4fd66f(0x1aa)][_0x4fd66f(0x199)](this,_0x32e9b7['slice'](0x1)))_0x8db398[_0x4fd66f(0x196)](null,this,_0x4fd66f(0x174));}else{if(Date[_0x4fd66f(0x16b)]()-_0x1c04c1>=this[_0x4fd66f(0x16d)][_0x4fd66f(0x1c0)])_0x8db398[_0x4fd66f(0x14f)](this,_0x32e9b7);}}['onQPress'](){const _0xa1913=_0x525934;if(!this[_0xa1913(0x169)])return;if(this[_0xa1913(0x18d)][_0xa1913(0x16d)][_0xa1913(0x176)]&&this['minions'][_0xa1913(0x1a0)]>0x0)this['controllingMinions']=!this['controllingMinions'];else this['handle'][_0xa1913(0x183)][_0xa1913(0x157)](this['player']);}get[_0x525934(0x1bf)](){const _0x350145=_0x525934;return this[_0x350145(0x18c)];}[_0x525934(0x181)](){const _0x5a7065=_0x525934;if(!this[_0x5a7065(0x169)]||!this[_0x5a7065(0x19c)])return;if(!this[_0x5a7065(0x169)])return;if(!this['player'][_0x5a7065(0x151)]){if(this[_0x5a7065(0x1a2)]!==null)this[_0x5a7065(0x1c4)][_0x5a7065(0x19e)][_0x5a7065(0x1c3)](this);this['spawningName']=null,this['splitAttempts']=0x0,this[_0x5a7065(0x145)]=0x0,this['requestingSpectate']=![],this[_0x5a7065(0x1a8)]=![],this[_0x5a7065(0x168)]=![];return;}this[_0x5a7065(0x19c)][_0x5a7065(0x166)]();const _0x184d03=[],_0x5411a8=[],_0x4b6ac6=[],_0x4b6827=[],_0x199e9f=this[_0x5a7065(0x19c)],_0xb5417c=_0x199e9f['visibleCells'],_0x1ef6f4=_0x199e9f[_0x5a7065(0x154)];for(let _0x5f2839 in _0xb5417c){const _0x134ef6=_0xb5417c[_0x5f2839];if(!_0x1ef6f4[_0x5a7065(0x180)](_0x5f2839))_0x184d03[_0x5a7065(0x163)](_0x134ef6);else{if(_0x134ef6['shouldUpdate'])_0x5411a8[_0x5a7065(0x163)](_0x134ef6);}}for(let _0x2664d3 in _0x1ef6f4){const _0x5811b2=_0x1ef6f4[_0x2664d3];if(_0xb5417c[_0x5a7065(0x180)](_0x2664d3))continue;if(_0x5811b2[_0x5a7065(0x1b0)]!==null)_0x4b6ac6[_0x5a7065(0x163)](_0x5811b2);_0x4b6827[_0x5a7065(0x163)](_0x5811b2);}if(_0x199e9f[_0x5a7065(0x1b5)]===0x1||_0x199e9f[_0x5a7065(0x1b5)]===0x2)this[_0x5a7065(0x158)]['onSpectatePosition'](_0x199e9f['viewArea']);if(this[_0x5a7065(0x1c4)][_0x5a7065(0x15e)]%0x4===0x0)this[_0x5a7065(0x1c4)][_0x5a7065(0x183)][_0x5a7065(0x19a)](this);this[_0x5a7065(0x158)][_0x5a7065(0x17b)](_0x184d03,_0x5411a8,_0x4b6ac6,_0x4b6827);}['onWorldSet'](){const _0x377c58=_0x525934;this[_0x377c58(0x158)][_0x377c58(0x182)](this[_0x377c58(0x19c)][_0x377c58(0x184)]['border'],!![],this[_0x377c58(0x158)]);}[_0x525934(0x19b)](_0x918539){const _0x5e54d7=_0x525934;this[_0x5e54d7(0x158)]['onNewOwnedCell'](_0x918539);}[_0x525934(0x167)](){const _0x373790=_0x525934;this[_0x373790(0x158)][_0x373790(0x167)]();}[_0x525934(0x1b7)](_0x439f48){const _0x1eb755=_0x525934;if(this[_0x1eb755(0x18c)]||!this[_0x1eb755(0x1b9)])return;this[_0x1eb755(0x159)][_0x1eb755(0x1b7)](_0x439f48);}['closeSocket'](_0x2c41bb,_0x1afeab){const _0x3e656f=_0x525934;if(this[_0x3e656f(0x18c)])return;this[_0x3e656f(0x18c)]=!![],this[_0x3e656f(0x178)]=_0x2c41bb,this[_0x3e656f(0x1ad)]=_0x1afeab,clearTimeout(this[_0x3e656f(0x1a5)]),this[_0x3e656f(0x159)]['close'](_0x2c41bb||0x3ee,_0x1afeab||'');}}module[_0x525934(0x14c)]=Connection;function _0x365d(_0x24985d,_0x2d9714){_0x24985d=_0x24985d-0x144;const _0x4611b4=_0x4611();let _0x365dea=_0x4611b4[_0x24985d];return _0x365dea;}const WebSocket=require('ws'),Listener=require(_0x525934(0x1ae)),Minion=require(_0x525934(0x15a)),Protocol=require(_0x525934(0x188));
